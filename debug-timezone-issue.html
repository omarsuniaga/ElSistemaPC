<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üêõ Debug: Problema de Zona Horaria</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f0f0f0;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .error { background: #ffeaa7; border-color: #fdcb6e; }
        .success { background: #d1f2eb; border-color: #00b894; }
        .code { 
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            margin: 10px 0;
        }
        .btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üêõ Debug: Problema de Zona Horaria en Fechas</h1>
        
        <div class="test-section">
            <h3>üéØ Problema Identificado</h3>
            <p>El calendario muestra "domingo 6 de julio" cuando deber√≠a mostrar "lunes 7 de julio"</p>
            <p><strong>Causa probable:</strong> Conversi√≥n de zona horaria UTC a local</p>
        </div>

        <div class="test-section">
            <h3>üß™ Tests de Fecha</h3>
            <button class="btn" onclick="runDateTest()">Ejecutar Test</button>
            <div class="code" id="testResults"></div>
        </div>

        <div class="test-section">
            <h3>‚úÖ Soluci√≥n Implementada</h3>
            <p>Usar parseo manual de fecha para evitar problemas de zona horaria:</p>
            <div class="code">// ‚ùå PROBLEM√ÅTICO (UTC conversion)
const date = new Date("2025-07-07")

// ‚úÖ CORRECTO (local date)
const [year, month, day] = "2025-07-07".split('-').map(Number)
const date = new Date(year, month - 1, day)</div>
        </div>

        <div class="test-section" id="resultSection" style="display:none;">
            <h3>üìä Resultado del Test</h3>
            <div id="finalResult"></div>
        </div>
    </div>

    <script>
        function runDateTest() {
            const testDateString = "2025-07-07"; // Lunes 7 de julio 2025
            let results = "";

            results += "üß™ TESTING FECHA: " + testDateString + "\\n";
            results += "=" + "=".repeat(50) + "\\n\\n";

            // Test 1: M√©todo problem√°tico (UTC)
            results += "‚ùå M√âTODO PROBLEM√ÅTICO (new Date string):\\n";
            const dateUTC = new Date(testDateString);
            results += `Fecha creada: ${dateUTC}\\n`;
            results += `getDay(): ${dateUTC.getDay()} (${['Domingo','Lunes','Martes','Mi√©rcoles','Jueves','Viernes','S√°bado'][dateUTC.getDay()]})\\n`;
            results += `toLocaleDateString(): ${dateUTC.toLocaleDateString('es-ES', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}\\n`;
            results += `Timezone offset: ${dateUTC.getTimezoneOffset()} minutos\\n\\n`;

            // Test 2: M√©todo correcto (manual parsing)
            results += "‚úÖ M√âTODO CORRECTO (manual parsing):\\n";
            const [year, month, day] = testDateString.split('-').map(Number);
            const dateLocal = new Date(year, month - 1, day);
            results += `Componentes: a√±o=${year}, mes=${month}, d√≠a=${day}\\n`;
            results += `Fecha creada: ${dateLocal}\\n`;
            results += `getDay(): ${dateLocal.getDay()} (${['Domingo','Lunes','Martes','Mi√©rcoles','Jueves','Viernes','S√°bado'][dateLocal.getDay()]})\\n`;
            results += `toLocaleDateString(): ${dateLocal.toLocaleDateString('es-ES', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}\\n\\n`;

            // Test 3: Comparaci√≥n
            results += "üìä COMPARACI√ìN:\\n";
            const isUTCCorrect = dateUTC.getDay() === 1; // Lunes = 1
            const isLocalCorrect = dateLocal.getDay() === 1;
            
            results += `UTC method day: ${dateUTC.getDay()} ${isUTCCorrect ? '‚úÖ' : '‚ùå'}\\n`;
            results += `Local method day: ${dateLocal.getDay()} ${isLocalCorrect ? '‚úÖ' : '‚ùå'}\\n\\n`;

            // Test 4: Verificaci√≥n del problema espec√≠fico
            results += "üéØ VERIFICACI√ìN DEL PROBLEMA ESPEC√çFICO:\\n";
            results += `Fecha input: ${testDateString} (deber√≠a ser lunes)\\n`;
            results += `UTC interpretation: ${dateUTC.toLocaleDateString('es-ES', { weekday: 'long' })} ${isUTCCorrect ? '‚úÖ' : '‚ùå'}\\n`;
            results += `Local interpretation: ${dateLocal.toLocaleDateString('es-ES', { weekday: 'long' })} ${isLocalCorrect ? '‚úÖ' : '‚ùå'}\\n\\n`;

            // Test 5: Info de zona horaria
            results += "üåç INFORMACI√ìN DE ZONA HORARIA:\\n";
            results += `Timezone: ${Intl.DateTimeFormat().resolvedOptions().timeZone}\\n`;
            results += `UTC Offset: ${new Date().getTimezoneOffset()} minutos\\n`;
            results += `UTC Offset horas: ${new Date().getTimezoneOffset() / 60} horas\\n\\n`;

            // Conclusi√≥n
            results += "üèÅ CONCLUSI√ìN:\\n";
            if (isLocalCorrect && !isUTCCorrect) {
                results += "‚úÖ PROBLEMA CONFIRMADO Y SOLUCI√ìN VERIFICADA\\n";
                results += "   El parseo manual corrige el desfase de zona horaria\\n";
            } else if (isUTCCorrect && isLocalCorrect) {
                results += "‚ö†Ô∏è  AMBOS M√âTODOS FUNCIONAN\\n";
                results += "   Puede que el problema est√© en otro lugar\\n";
            } else {
                results += "‚ùå PROBLEMA COMPLEJO\\n";
                results += "   Se requiere m√°s investigaci√≥n\\n";
            }

            document.getElementById('testResults').textContent = results;
            
            // Mostrar resultado final
            const resultSection = document.getElementById('resultSection');
            const finalResult = document.getElementById('finalResult');
            
            resultSection.style.display = 'block';
            if (isLocalCorrect && !isUTCCorrect) {
                resultSection.className = 'test-section success';
                finalResult.innerHTML = `
                    <h4>‚úÖ Problema Identificado y Corregido</h4>
                    <p>El desfase de fecha era causado por la interpretaci√≥n UTC del string de fecha.</p>
                    <p><strong>Soluci√≥n:</strong> Parseo manual de componentes de fecha.</p>
                `;
            } else {
                resultSection.className = 'test-section error';
                finalResult.innerHTML = `
                    <h4>‚ö†Ô∏è Requiere M√°s Investigaci√≥n</h4>
                    <p>El problema puede estar en otra parte del c√≥digo.</p>
                `;
            }
        }

        // Auto-run test
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(runDateTest, 1000);
        });
    </script>
</body>
</html>
