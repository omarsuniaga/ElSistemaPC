<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚úÖ Demo: Calendarios con Zona Horaria Corregida</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background: #f8fafc;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.07);
            margin-bottom: 20px;
        }
        .success {
            background: linear-gradient(135deg, #d1f2eb, #a8e6cf);
            border-left: 4px solid #00b894;
        }
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            margin: 15px 0;
            overflow-x: auto;
        }
        .fix-highlight {
            background: #48bb78;
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
        }
        .before-after {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .before {
            background: #fed7d7;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #e53e3e;
        }
        .after {
            background: #c6f6d5;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #38a169;
        }
        .demo-links {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .demo-link {
            background: #667eea;
            color: white;
            padding: 15px;
            border-radius: 8px;
            text-decoration: none;
            text-align: center;
            font-weight: 500;
            transition: transform 0.2s ease;
        }
        .demo-link:hover {
            transform: translateY(-2px);
            background: #5a67d8;
        }
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 500;
            margin-left: 10px;
        }
        .fixed { background: #48bb78; color: white; }
        .issue { background: #e53e3e; color: white; }
    </style>
</head>
<body>
    <div class="container success">
        <h1>‚úÖ Calendarios con Zona Horaria Corregida</h1>
        <p>Los problemas de <strong>desfase de zona horaria</strong> han sido resueltos en todos los componentes del calendario.</p>
        
        <div class="status-badge fixed">ARREGLADO</div>
        <div class="status-badge fixed">PRODUCCI√ìN READY</div>
    </div>

    <div class="container">
        <h2>üéØ Problema Original Identificado</h2>
        <p>El calendario mostraba fechas incorrectas debido a la conversi√≥n autom√°tica UTC:</p>
        
        <div class="before-after">
            <div class="before">
                <h4>‚ùå ANTES (Problem√°tico)</h4>
                <p><strong>Input:</strong> "2025-07-07" (Lunes)</p>
                <p><strong>Mostrado:</strong> "domingo, 6 de julio de 2025"</p>
                <p><strong>Causa:</strong> Conversi√≥n UTC autom√°tica</p>
            </div>
            
            <div class="after">
                <h4>‚úÖ DESPU√âS (Corregido)</h4>
                <p><strong>Input:</strong> "2025-07-07" (Lunes)</p>
                <p><strong>Mostrado:</strong> "lunes, 7 de julio de 2025"</p>
                <p><strong>Soluci√≥n:</strong> Parseo manual de componentes</p>
            </div>
        </div>
    </div>

    <div class="container">
        <h2>üîß Archivos Corregidos</h2>
        
        <h3>1. AttendanceCalendarOptimized.vue <span class="fix-highlight">CORREGIDO</span></h3>
        <p><strong>Cambios aplicados:</strong></p>
        <ul>
            <li>Funci√≥n <code>isSelectedDate()</code> - Parseo manual de fecha</li>
            <li>Watch de <code>props.selectedDate</code> - Evita conversi√≥n UTC</li>
            <li>Lifecycle <code>onMounted()</code> - Inicializaci√≥n segura</li>
            <li>Eliminado import <code>parseISO</code> no utilizado</li>
        </ul>

        <div class="code-block">// ‚ùå ANTES (Problem√°tico)
const selectedDateParsed = parseISO(props.selectedDate)

// ‚úÖ DESPU√âS (Corregido)
const [year, month, day] = props.selectedDate.split("-").map(Number)
const selectedDateParsed = new Date(year, month - 1, day)</div>

        <h3>2. ClassesModal.vue <span class="fix-highlight">CORREGIDO</span></h3>
        <p><strong>Cambios aplicados:</strong></p>
        <ul>
            <li>Watch de <code>props.date</code> - Formateo correcto de fecha</li>
            <li>Eliminados imports no utilizados (<code>parseISO</code>, <code>formatISO</code>, <code>onMounted</code>)</li>
            <li>Parseo manual para evitar desfase de d√≠a</li>
        </ul>

        <div class="code-block">// ‚ùå ANTES (Problem√°tico)
const dateObj = parseISO(newDate)

// ‚úÖ DESPU√âS (Corregido)  
const [year, month, day] = newDate.split("-").map(Number)
const dateObj = new Date(year, month - 1, day)</div>
    </div>

    <div class="container">
        <h2>üß™ Verificaci√≥n de la Soluci√≥n</h2>
        
        <p>La correcci√≥n utiliza el mismo patr√≥n exitoso aplicado en el nuevo calendario:</p>
        
        <div class="code-block">// üéØ PATR√ìN DE SOLUCI√ìN UNIVERSAL
// En lugar de usar parseISO() o new Date(string) que causan conversi√≥n UTC:

function parseDateSafely(dateString) {
    const [year, month, day] = dateString.split("-").map(Number)
    return new Date(year, month - 1, day)  // ‚úÖ Sin conversi√≥n UTC
}

// Este patr√≥n garantiza que:
// - "2025-07-07" siempre sea interpretado como Lunes 7 de julio
// - No hay desfase por zona horaria
// - La fecha mostrada coincide con la fecha esperada</div>

        <h3>üìä Prueba en Tiempo Real</h3>
        <button onclick="testTimezonefix()" style="background: #667eea; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin: 10px 0;">
            üß™ Ejecutar Prueba de Zona Horaria
        </button>
        <div id="testResults" style="background: #f7fafc; padding: 15px; border-radius: 8px; margin-top: 10px; font-family: monospace;"></div>
    </div>

    <div class="container">
        <h2>üöÄ Enlaces de Prueba</h2>
        <p>Todos los calendarios ahora funcionan correctamente:</p>
        
        <div class="demo-links">
            <a href="http://localhost:5173/attendance-calendar" class="demo-link">
                üìÖ Nuevo Calendario (NewTeacherAttendanceDashboard)
            </a>
            <a href="http://localhost:5173/attendance" class="demo-link">
                üìä Calendario Optimizado (AttendanceCalendarOptimized)
            </a>
            <a href="http://localhost:5173/teacher" class="demo-link">
                üè† Dashboard Principal (TeacherHome)
            </a>
            <a href="debug-timezone-issue.html" class="demo-link">
                üîß Debug de Zona Horaria
            </a>
        </div>
    </div>

    <div class="container success">
        <h2>‚úÖ Estado Final</h2>
        <ul>
            <li><strong>‚úÖ Problema Original:</strong> "Ensayo General" en domingo ‚Üí RESUELTO</li>
            <li><strong>‚úÖ Problema de Zona Horaria:</strong> Desfase de d√≠as ‚Üí RESUELTO</li>
            <li><strong>‚úÖ Calendario Nuevo:</strong> Arquitectura limpia ‚Üí IMPLEMENTADO</li>
            <li><strong>‚úÖ Calendarios Existentes:</strong> Zona horaria corregida ‚Üí ACTUALIZADO</li>
            <li><strong>‚úÖ Ruta Directa:</strong> /attendance-calendar ‚Üí FUNCIONAL</li>
        </ul>
        
        <p><strong>üéâ Todos los calendarios est√°n ahora libres de problemas de zona horaria y funcionan correctamente.</strong></p>
    </div>

    <script>
        function testTimezonefix() {
            const testDate = "2025-07-07"
            let results = ""
            
            results += "üß™ TESTING CORRECCI√ìN DE ZONA HORARIA\\n"
            results += "=" + "=".repeat(45) + "\\n\\n"
            
            // M√©todo problem√°tico
            results += "‚ùå M√âTODO ANTERIOR (parseISO/new Date string):\\n"
            const dateUTC = new Date(testDate)
            results += `Input: ${testDate}\\n`
            results += `Output: ${dateUTC.toLocaleDateString('es-ES', { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' })}\\n`
            results += `D√≠a correcto: ${dateUTC.getDay() === 1 ? '‚úÖ' : '‚ùå'}\\n\\n`
            
            // M√©todo corregido
            results += "‚úÖ M√âTODO CORREGIDO (parseo manual):\\n"
            const [year, month, day] = testDate.split("-").map(Number)
            const dateLocal = new Date(year, month - 1, day)
            results += `Input: ${testDate}\\n`
            results += `Parseo: a√±o=${year}, mes=${month}, d√≠a=${day}\\n`
            results += `Output: ${dateLocal.toLocaleDateString('es-ES', { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' })}\\n`
            results += `D√≠a correcto: ${dateLocal.getDay() === 1 ? '‚úÖ' : '‚ùå'}\\n\\n`
            
            // Conclusi√≥n
            results += "üèÅ RESULTADO:\\n"
            if (dateLocal.getDay() === 1 && dateUTC.getDay() !== 1) {
                results += "‚úÖ CORRECCI√ìN EXITOSA\\n"
                results += "   El parseo manual resuelve el desfase de zona horaria\\n"
            } else {
                results += "‚ö†Ô∏è  Verificar configuraci√≥n de zona horaria del sistema\\n"
            }
            
            document.getElementById('testResults').textContent = results
        }
        
        // Auto-ejecutar test al cargar
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(testTimezonefix, 500)
        })
    </script>
</body>
</html>
